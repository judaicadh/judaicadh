<!DOCTYPE html>
<html lang="en">
<head>
    <title>dc.js - Pie Chart Example</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="kaplan.css"/>
</head>
<body>
<h2>Kaplan Pie Chart</h2>
	<p>
An asterisk(*) indicates that objects have not been been photographed may not be catalogued. <br>
Click the different items in the legend to see the selected slices in the pie chart or click the slices in the pie chart to see more information about each specific slice.</p><br>
<div id="test"></div>

<script type="text/javascript" src="../js/d3.js"></script>
<script type="text/javascript" src="../js/crossfilter.js"></script>
<script type="text/javascript" src="../js/dc.js"></script>
<script type="text/javascript">


var chart = dc.pieChart("#test");
d3.csv("1.csv", function(error, data) {

  var ndx  = crossfilter(data),
      runDimension  = ndx.dimension(function(d) {return ""+d.Name;})
      
     gainOrLossGroup = runDimension.group().reduceSum(function(d) {return d.Number *1 ;});
var tots = d3.sum(data, function(d) {return d.values;});

 
  var adjustX = 20, adjustY = 40;
  chart
    .width(window.innerWidth-adjustX)
    .height(window.innerHeight-adjustY)
    .slicesCap(7)
    .innerRadius(100)
    .dimension(runDimension)
    .group(gainOrLossGroup)
	.legend(dc.legend())
    .externalLabels(10)
    .ordinalColors(['#6568D1','#FF9308','#106FB2','#FFBC66','#E1075F','#06C352','#5799C8'])
    .renderTitle(true)
    .title(function (p) {
            return [
                p.key,
                'Index Gain: ' + (p.value.Number),
         
                'Fluctuation / Index Ratio: ' + (p.value.tots) + '%'
            ].join('\n');
        })
  
  window.onresize = function() {
      chart
          .width(window.innerWidth-adjustX)
          .height(window.innerHeight-adjustY)
          .redraw();
  };

  
  chart.render();


});

</script>

</body>
</html>
